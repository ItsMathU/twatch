{"paragraphs":[{"text":"import org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\nimport scala.io.Source\nimport scala.collection.mutable.HashMap\nimport java.io.File\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport sys.process.stringSeqToProcess\n\n/** Configures the Oauth Credentials for accessing Twitter */\ndef configureTwitterCredentials(apiKey: String, apiSecret: String, accessToken: String, accessTokenSecret: String) {\n  val configs = new HashMap[String, String] ++= Seq(\n    \"apiKey\" -> apiKey, \"apiSecret\" -> apiSecret, \"accessToken\" -> accessToken, \"accessTokenSecret\" -> accessTokenSecret)\n  println(\"Configuring Twitter OAuth\")\n  configs.foreach{ case(key, value) =>\n    if (value.trim.isEmpty) {\n      throw new Exception(\"Error setting authentication - value for \" + key + \" not set\")\n    }\n    val fullKey = \"twitter4j.oauth.\" + key.replace(\"api\", \"consumer\")\n    System.setProperty(fullKey, value.trim)\n    println(\"\\tProperty \" + fullKey + \" set as [\" + value.trim + \"]\")\n  }\n  println()\n}\n\n// Configure Twitter credentials\nval apiKey = \"SdhUBkzAykDBVy3giWqIicfa3\"\nval apiSecret = \"djOcSWm5RWl1tWVjddV6rjZ7eyMmnI1XSKaNy099uggZ4QTk3p\"\nval accessToken = \"22812854-YuZihbyvV9LuNHn0YtAcQrzbCXC1nrzuiKHGGbvff\"\nval accessTokenSecret = \"rjnBk1c3P2SjLWr2cHjQo6J95IlxHiF0eNCIxC3aiboKB\"\nconfigureTwitterCredentials(apiKey, apiSecret, accessToken, accessTokenSecret)\n\nimport org.apache.spark.streaming.twitter._\nval ssc = new StreamingContext(sc, Seconds(2))\nval tweets = TwitterUtils.createStream(ssc, None)\nval twt = tweets.window(Seconds(60))\n\ncase class Tweet(createdAt:Long, text:String)\ntwt.map(status=>\n  Tweet(status.getCreatedAt().getTime()/1000, status.getText())\n).foreachRDD(rdd=>\n  // Below line works only in spark 1.3.0.\n  // For spark 1.1.x and spark 1.2.x,\n  // use rdd.registerTempTable(\"tweets\") instead.\n  rdd.toDF().registerTempTable(\"tweets\")\n  // rdd.foreach(x=>println(x.text))\n \n)\n\ntwt.print\n\nssc.start()","user":"anonymous","dateUpdated":"2018-02-21T23:44:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\nimport scala.io.Source\nimport scala.collection.mutable.HashMap\nimport java.io.File\nimport org.apache.log4j.Logger\nimport org.apache.log4j.Level\nimport sys.process.stringSeqToProcess\nconfigureTwitterCredentials: (apiKey: String, apiSecret: String, accessToken: String, accessTokenSecret: String)Unit\napiKey: String = SdhUBkzAykDBVy3giWqIicfa3\napiSecret: String = djOcSWm5RWl1tWVjddV6rjZ7eyMmnI1XSKaNy099uggZ4QTk3p\naccessToken: String = 22812854-YuZihbyvV9LuNHn0YtAcQrzbCXC1nrzuiKHGGbvff\naccessTokenSecret: String = rjnBk1c3P2SjLWr2cHjQo6J95IlxHiF0eNCIxC3aiboKB\nConfiguring Twitter OAuth\n\tProperty twitter4j.oauth.consumerKey set as [SdhUBkzAykDBVy3giWqIicfa3]\n\tProperty twitter4j.oauth.accessToken set as [22812854-YuZihbyvV9LuNHn0YtAcQrzbCXC1nrzuiKHGGbvff]\n\tProperty twitter4j.oauth.consumerSecret set as [djOcSWm5RWl1tWVjddV6rjZ7eyMmnI1XSKaNy099uggZ4QTk3p]\n\tProperty twitter4j.oauth.accessTokenSecret set as [rjnBk1c3P2SjLWr2cHjQo6J95IlxHiF0eNCIxC3aiboKB]\n\nimport org.apache.spark.streaming.twitter._\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@100845f5\ntweets: org.apache.spark.streaming.dstream.ReceiverInputDStream[twitter4j.Status] = org.apache.spark.streaming.twitter.TwitterInputDStream@7fb3d52f\ntwt: org.apache.spark.streaming.dstream.DStream[twitter4j.Status] = org.apache.spark.streaming.dstream.WindowedDStream@79110b0a\ndefined class Tweet\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1519252381204_-1092333933","id":"20180221-223301_1370916339","dateCreated":"2018-02-21T22:33:01+0000","dateStarted":"2018-02-21T23:44:03+0000","dateFinished":"2018-02-21T23:44:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15960"},{"text":"%sql select * from tweets where text like '%girl%' limit 10","user":"anonymous","dateUpdated":"2018-02-21T23:48:58+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"createdAt\ttext\n1519256877\t@thistallawkgirl @MaureenDowdTwit 🔥🔥🔥\n1519256877\tpigs lick naked girl https://t.co/hUtnyogcEd\n1519256884\tRT @TrueAnal: Some @alexgreyxxx helps get over #humpday 🍒🍑 See why: https://t.co/Fxeg6UBNxP 🌟 #badgirls #sexyasf https://t.co/cTZNoYm3gw\n1519256885\tRT @DougRutherfor10: @Devinri40379533 @PaulaLanier54 Somebody hot butt hurt. Go girl\n1519256891\tthought I told that girl the world is mine\n1519256894\tRT @iamtimeverson: Iola girls trail Wellsville 33-13 at the half.\n1519256894\tRT @girlposts: my mom trying to be my friend after yelling at me over dumb stuff https://t.co/P3Z3d1KZEp\n1519256899\tskinhead girl images porn muslim porn free https://t.co/den7TwXKoY\n1519256903\tRT @baylor_hendrix: passing up a perfect girl whose all about you just because you wanna have fun is the dumbest thing a boy could do\n1519256924\t@girlhuntballet :( i love you my biggest supporter\n"}]},"apps":[],"jobName":"paragraph_1519256643005_-664055931","id":"20180221-234403_2025011838","dateCreated":"2018-02-21T23:44:03+0000","dateStarted":"2018-02-21T23:48:58+0000","dateFinished":"2018-02-21T23:48:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15961"},{"text":"%sql select createdAt, count(1) from tweets group by createdAt order by createdAt","user":"anonymous","dateUpdated":"2018-02-21T23:45:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"createdAt\tcount(1)\n1519256659\t30\n1519256660\t40\n1519256661\t31\n1519256662\t41\n1519256663\t41\n1519256664\t38\n1519256665\t39\n1519256666\t30\n1519256667\t40\n1519256668\t39\n1519256669\t45\n1519256670\t26\n1519256671\t30\n1519256672\t37\n1519256673\t37\n1519256674\t41\n1519256675\t37\n1519256676\t29\n1519256677\t33\n1519256678\t37\n1519256679\t36\n1519256680\t36\n1519256681\t42\n1519256682\t35\n1519256683\t31\n1519256684\t29\n1519256685\t36\n1519256686\t39\n1519256687\t38\n1519256688\t37\n1519256689\t37\n1519256690\t39\n1519256691\t40\n1519256692\t40\n1519256693\t36\n1519256694\t32\n1519256695\t33\n1519256696\t29\n1519256697\t35\n1519256698\t36\n1519256699\t26\n1519256700\t42\n1519256701\t42\n1519256702\t37\n1519256703\t50\n1519256704\t42\n1519256705\t46\n1519256706\t49\n1519256707\t42\n1519256708\t43\n1519256709\t33\n1519256710\t43\n1519256711\t35\n1519256712\t47\n"}]},"apps":[],"jobName":"paragraph_1519256685478_629732027","id":"20180221-234445_40573812","dateCreated":"2018-02-21T23:44:45+0000","dateStarted":"2018-02-21T23:45:15+0000","dateFinished":"2018-02-21T23:45:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15962"},{"text":"def sentiment(s:String) : String = {\n    val positive = Array(\"like\", \"love\", \"good\", \"great\", \"happy\", \"cool\", \"the\", \"one\", \"that\")\n    val negative = Array(\"hate\", \"bad\", \"stupid\", \"is\")\n\n    var st = 0;\n\n    val words = s.split(\" \")    \n    positive.foreach(p =>\n        words.foreach(w =>\n            if(p==w) st = st+1\n        )\n    )\n\n    negative.foreach(p=>\n        words.foreach(w=>\n            if(p==w) st = st-1\n        )\n    )\n    if(st>0)\n        \"positivie\"\n    else if(st<0)\n        \"negative\"\n    else\n        \"neutral\"\n}\n\nsqlc.udf.register(\"sentiment\", sentiment _)\n","user":"anonymous","dateUpdated":"2018-02-21T23:48:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sentiment: (s: String)String\nres13: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n"}]},"apps":[],"jobName":"paragraph_1519256715233_921787090","id":"20180221-234515_2048188005","dateCreated":"2018-02-21T23:45:15+0000","dateStarted":"2018-02-21T23:48:28+0000","dateFinished":"2018-02-21T23:48:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15963"},{"text":"%sql select sentiment(text), count(1) from tweets where text like '%girl%' group by sentiment(text)\n","user":"anonymous","dateUpdated":"2018-02-21T23:48:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"UDF(text)\tcount(1)\nneutral\t10\npositivie\t2\n"}]},"apps":[],"jobName":"paragraph_1519256897153_127725013","id":"20180221-234817_1688535276","dateCreated":"2018-02-21T23:48:17+0000","dateStarted":"2018-02-21T23:48:44+0000","dateFinished":"2018-02-21T23:48:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15964"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2018-02-21T23:48:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1519256924452_1464758089","id":"20180221-234844_1291590405","dateCreated":"2018-02-21T23:48:44+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:15965"}],"name":"Twitter","id":"2D9G423MB","angularObjects":{"2D9PEUYCG:shared_process":[],"2D8MBCTTU:shared_process":[],"2D6611M12:shared_process":[],"2D77AZN98:shared_process":[],"2D74UYUNZ:shared_process":[],"2D8EZRBZE:shared_process":[],"2D6BYFS1D:shared_process":[],"2D6JZUFKG:shared_process":[],"2D892YETM:shared_process":[],"2D8UJJ9HU:shared_process":[],"2D8QJWW1B:shared_process":[],"2D95H8VVP:shared_process":[],"2D619CFP3:shared_process":[],"2D84WSRQJ:shared_process":[],"2D9UBWRCK:shared_process":[],"2D9DTMF2M:shared_process":[],"2D6VUDXH1:shared_process":[],"2D7R9HJJB:shared_process":[],"2D6CQ1E1B:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}